index.html

<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!-- Force HTTPS for PWA -->
    <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
    <title>BSCEEEY2S1</title>
    <link rel="manifest" href="manifest.json">
    <!-- iOS Safari PWA Support -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-title" content="BSCEEE Y2S1">
    <link rel="apple-touch-icon" href="pngegg.png">
    <link rel="stylesheet" href="style.css">
    <link rel="icon" href="pngegg.png">
    <!-- Add Firebase -->
    <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-database-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-messaging-compat.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">

    <style>
        /* Custom Sections Styles */
        .custom-section {
            background: var(--bg-primary);
            border-radius: 20px;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: 0 2px 8px var(--shadow);
            transition: var(--transition);
            border: 1px solid var(--border);
            border-left: 4px solid var(--primary);
        }

        .custom-section:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 24px var(--shadow-lg);
        }

        .custom-section h2 {
            color: var(--primary);
            text-align: center;
            margin-bottom: 30px;
            font-size: 2em;
        }

        .text-content {
            line-height: 1.6;
            font-size: 1.1em;
            max-width: 100%;
            text-align: left;
            /* Add this line */
            padding: 0 20px;
            /* Add this line for better spacing */
        }

        .documents-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;

            background: var(--bg-primary);
            border-radius: 20px;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: 0 2px 8px var(--shadow);
            transition: var(--transition);
            border: 1px solid var(--border);
        }

        .document-card {
            background: var(--bg-primary);
            border-radius: 20px;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: 0 2px 8px var(--shadow);
            transition: var(--transition);
            border: 1px solid var(--border);
        }

        .document-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }

        .document-card h4 {
            color: #004080;
            margin-bottom: 10px;
        }

        .document-card p {
            color: #666;
            margin-bottom: 15px;
        }

        .doc-link {
            display: inline-block;
            background: #004080;
            color: white;
            padding: 8px 16px;
            border-radius: 5px;
            text-decoration: none;
            transition: background 0.3s ease;
        }

        .doc-link:hover {
            background: #003366;
            text-decoration: none;
        }

        .links-list {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .link-item {
            background: white;
            padding: 15px;
            border-radius: 8px;
            border-left: 4px solid #004080;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .link-url {
            color: #004080;
            text-decoration: none;
            font-weight: 600;
            font-size: 1.1em;
            display: block;
            margin-bottom: 5px;
        }

        .link-url:hover {
            text-decoration: underline;
        }

        .link-desc {
            color: #666;
            margin: 5px 0 0 0;
            font-size: 0.9em;
        }

        /* Ensure white background sections have proper contrast */
        .custom-section[style*="background: white"],
        .custom-section[style*="background:#fff"],
        .custom-section[style*="background: #fff"] {
            border-top: 1px solid #e9ecef;
            border-bottom: 1px solid #e9ecef;
        }




        /*  
        .christmas-banner {
            background: linear-gradient(135deg, #c00 0%, #008000 100%);
            color: white;
            text-align: center;
            padding: 30px 20px;
            margin: 25px 0;
            border-radius: 15px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
            position: relative;
            overflow: hidden;
            border: 4px solid #ffd700;
            z-index: 2;
        }

        .christmas-banner::before,
        .christmas-banner::after {
            content: "‚ùÑ";
            position: absolute;
            top: 15px;
            font-size: 2em;
            opacity: 0.7;
            animation: float 3s ease-in-out infinite;
        }

        .christmas-banner::before {
            left: 20px;
            animation-delay: 0s;
        }

        .christmas-banner::after {
            right: 20px;
            animation-delay: 1.5s;
        }

        .christmas-banner h2 {
            color: #ffd700;
            margin-bottom: 15px;
            font-size: 2.2em;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.4);
            text-align: center;
        }

        .christmas-banner p {
            font-size: 1.3em;
            margin: 0;
            max-width: 800px;
            margin: 0 auto;
        }

        @keyframes float {

            0%,
            100% {
                transform: translateY(0);
            }

            50% {
                transform: translateY(-10px);
            }
        }

        
        .exam-motivation {
            background: linear-gradient(135deg, #004080 0%, #0066cc 100%);
            color: white;
            padding: 35px 25px;
            margin: 30px 0;
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 8px 25px rgba(0, 64, 128, 0.4);
            border: 4px solid #ffd700;
            position: relative;
            z-index: 2;
        }

        .exam-motivation h2 {
            text-align: center;
            color: #ffd700;
            font-size: 2.2em;
            margin-bottom: 20px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.4);
        }

        .exam-motivation p {
            font-size: 1.3em;
            line-height: 1.7;
            margin-bottom: 15px;
            max-width: 900px;
            margin-left: auto;
            margin-right: auto;
        }

        .exam-motivation::before,
        .exam-motivation::after {
            content: "üéÑ";
            position: absolute;
            top: 15px;
            font-size: 2em;
            opacity: 0.6;
        }

        .exam-motivation::before {
            left: 20px;
        }

        .exam-motivation::after {
            right: 20px;
        }

       
        .christmas-lights {
            height: 10px;
            background: repeating-linear-gradient(90deg,
                    #ff0000 0px, #ff0000 15px,
                    #00ff00 15px, #00ff00 30px,
                    #ffffff 30px, #ffffff 45px,
                    #ffd700 45px, #ffd700 60px);
            margin: 20px 0;
            border-radius: 5px;
            animation: lightsMove 2s linear infinite;
            box-shadow:
                0 0 10px rgba(255, 0, 0, 0.6),
                0 0 20px rgba(0, 255, 0, 0.4),
                inset 0 2px 4px rgba(255, 255, 255, 0.3);
            position: relative;
            z-index: 2;
        }

        .christmas-lights::before {
            content: "";
            position: absolute;
            top: -2px;
            left: 0;
            right: 0;
            height: 2px;
            background: linear-gradient(90deg,
                    transparent,
                    rgba(255, 255, 255, 0.8),
                    transparent);
            filter: blur(1px);
        }

        @keyframes lightsMove {
            0% {
                background-position: 0 0;
            }

            100% {
                background-position: 60px 0;
            }
        }

       
        .hero.christmas-mode {
            position: relative;
            overflow: hidden;
        }

        .hero.christmas-mode::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background:

                url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><text y="0.9em" font-size="90" fill="%2300e100" opacity="0.25">üéÑ</text></svg>');
            background-size: 80px;
            background-repeat: repeat;
            z-index: 1;
        }

        .hero.christmas-mode .hero-text {
            position: relative;
            z-index: 2;
        }

        
        .snowflakes-container {
            position: relative;
            height: 80px;
            overflow: visible;
            margin: 0;
            z-index: 1;
            pointer-events: none;
        }

        .snowflake {
            position: absolute;
            color: blue;
            text-shadow:
                0 0 8px rgba(255, 255, 255, 0.9),
                0 0 16px rgba(255, 255, 255, 0.7);
            opacity: 0;
            animation: snowFall linear infinite;
            pointer-events: none;
            filter: drop-shadow(0 0 3px white);
            z-index: 1;
        }

        @keyframes snowFall {
            0% {
                transform: translateY(-20px) rotate(0deg);
                opacity: 0;
            }

            10% {
                opacity: 0.9;
            }

            90% {
                opacity: 0.9;
            }

            100% {
                transform: translateY(100px) rotate(360deg);
                opacity: 0;
            }
        }


       
        .site-footer {
            position: relative;
        }

        .site-footer::before {
            content: "üéÖ üéÑ üéÅ ‚ú®";
            position: absolute;
            top: -25px;
            left: 0;
            right: 0;
            text-align: center;
            font-size: 1.5em;
            color: #ffd700;
            animation: twinkle 2s infinite;
        }

        @keyframes twinkle {

            0%,
            100% {
                opacity: 1;
            }

            50% {
                opacity: 0.7;
            }
        }

       
        .fade-in {
            animation: fadeInUp 0.8s ease-out;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        } */

        /* ==================== INSTALL BUTTON STYLES ==================== */
        #installButton {
            background: linear-gradient(135deg, #004080 0%, #0066cc 100%);
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            font-size: 0.9em;
            transition: all 0.3s ease;
            margin-right: 10px;
            box-shadow: 0 2px 5px rgba(0, 64, 128, 0.3);
        }

        #installButton:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 10px rgba(0, 64, 128, 0.4);
            background: linear-gradient(135deg, #003366 0%, #0055aa 100%);
        }

        #installButton:active {
            transform: translateY(0);
        }

        #installButton i {
            margin-right: 5px;
        }

        /* Dark theme support */
        [data-theme="dark"] #installButton {
            background: linear-gradient(135deg, #0066cc 0%, #004080 100%);
            box-shadow: 0 2px 5px rgba(0, 102, 204, 0.3);
        }

        [data-theme="dark"] #installButton:hover {
            background: linear-gradient(135deg, #0055aa 0%, #003366 100%);
            box-shadow: 0 4px 10px rgba(0, 102, 204, 0.4);
        }

        /* Mobile responsive */
        @media (max-width: 768px) {
            #installButton {
                padding: 8px 12px;
                font-size: 0.8em;
                margin-right: 5px;
            }

            #installButton span {
                display: none;
                /* Hide text on mobile, show only icon */
            }

            #installButton i {
                margin-right: 0;
                font-size: 1.2em;
            }
        }

        @media (max-width: 480px) {
            #installButton {
                padding: 6px 10px;
            }
        }

        /* ==================== NOTIFICATION BELL STYLES ==================== */

        .notification-icon {
            position: relative;
            margin-right: 15px;
        }

        .notification-icon a {
            color: #004080;
            font-size: 1.3em;
            text-decoration: none;
            display: flex;
            align-items: center;
            justify-content: center;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            transition: all 0.3s ease;
        }

        .notification-icon a:hover {
            background: rgba(0, 64, 128, 0.1);
            transform: scale(1.1);
        }

        .notification-badge {
            position: absolute;
            top: -5px;
            right: -5px;
            background: #dc3545;
            color: white;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            font-size: 0.7em;
            font-weight: bold;
            display: flex;
            align-items: center;
            justify-content: center;
            animation: pulse 1.5s infinite;
            box-shadow: 0 2px 5px rgba(220, 53, 69, 0.3);
        }

        @keyframes pulse {
            0% {
                transform: scale(1);
                box-shadow: 0 0 0 0 rgba(220, 53, 69, 0.4);
            }

            70% {
                transform: scale(1.1);
                box-shadow: 0 0 0 5px rgba(220, 53, 69, 0);
            }

            100% {
                transform: scale(1);
                box-shadow: 0 0 0 0 rgba(220, 53, 69, 0);
            }
        }

        /* Dark theme support */
        [data-theme="dark"] .notification-icon a {
            color: var(--primary);
        }

        [data-theme="dark"] .notification-icon a:hover {
            background: rgba(var(--primary-rgb), 0.1);
        }

        /* Mobile responsive */
        @media (max-width: 768px) {
            .notification-icon {
                margin-right: 10px;
            }

            .notification-icon a {
                width: 36px;
                height: 36px;
                font-size: 1.2em;
            }

            .notification-badge {
                width: 18px;
                height: 18px;
                font-size: 0.6em;
            }
        }

        @keyframes shake {

            0%,
            100% {
                transform: rotate(0deg);
            }

            25% {
                transform: rotate(-15deg);
            }

            75% {
                transform: rotate(15deg);
            }
        }
    </style>
</head>

<body>

    <!-- Top Nav -->
    <header>
        <div id="overlay"></div>
        <nav>
            <div class="nav-left">
                <button id="menuBtn"><i class="fas fa-bars"></i></button>
                <div class="logo">
                    <img src="GALLERY/image-removebg-preview.png" alt="Chuka University Logo">
                    <div class="logo-text">
                        <h1>Chuka University</h1>
                        <p>Faculty of Engineering</p>
                    </div>
                </div>
            </div>

            <div class="nav-actions">
                <div id="adminIndicator">
                    <i class="fas fa-crown"></i> Admin
                </div>
                <div class="notification-icon" id="notificationBell">
                    <a href="announcements.html">
                        <i class="fas fa-bell"></i>
                        <span id="notificationCount" class="notification-badge">0</span>
                    </a>
                </div>
                <button id="installButton" style="display: none;">
                    <i class="fas fa-download"></i> Install App
                </button>
                <button id="themeToggle">
                    <i class="fas fa-moon"></i>
                </button>
            </div>
        </nav>
    </header>

    <div id="sidebar">
        <a href="index.html"><i class="fas fa-home"></i> Home</a>
        <a href="timetable.html"><i class="fas fa-calendar"></i> Timetable</a>
        <a href="assignments.html"><i class="fas fa-tasks"></i> Assignments</a>
        <a href="studydocs.html"><i class="fas fa-book"></i> Study Documents</a>
         <a href="announcements.html"><i class="fas fa-bullhorn"></i> Announcements</a>
        <a href="practical-hub.html"><i class="fas fa-microchip"></i> Practical Electronics Hub</a>
        <a href="gallery.html"><i class="fas fa-images"></i> Gallery</a>
        <a href="sports.html"><i class="fas fa-futbol"></i> Sports</a>
        <a href="personell.html"><i class="fas fa-users"></i> Personnel</a>
        <a href="registration.html"><i class="fas fa-clipboard-list"></i> Registration</a>
        <a href="support.html"><i class="fas fa-life-ring"></i> Academic Support</a>
        <a href="admin-login.html" id="adminLoginLink"><i class="fas fa-lock"></i> Admin Login</a>
        <a href="admin-dashboard.html" id="adminDashboardLink" style="display: none;"><i class="fas fa-cogs"></i>
            Dashboard</a>
    </div>

    <!-- Main Content -->
    <main class="content">
        <!-- Christmas Theme Sections 
        <div class="snowflakes-container" id="snowflakesContainer"></div>

        <section class="christmas-banner fade-in">
            <h2>üéÑ Exams Are Over! Time to Celebrate! üéâ</h2>
            <p>Congratulations on completing your exams! Wishing all BSCEEE students a well-deserved break filled with
                joy, relaxation, and holiday cheer!</p>
        </section>

        <div class="christmas-lights"></div>

        <section class="exam-motivation fade-in">
            <h2>üéâ Congratulations on Completing Your Exams! üéì</h2>
            <p>üåü Well done! You've successfully completed your semester exams! Your hard work and dedication have paid
                off!</p>
            <p>üéØ <strong>Time to Relax:</strong> Take a well-deserved break, recharge, and enjoy the holiday season.
            </p>
            <p>ü§ù <strong>Celebrate Together:</strong> Share your success with classmates and enjoy this festive period.
            </p>
            <p>‚ú® <strong>You Did It!</strong> All your late nights and hard studying have brought you to this moment.
                Enjoy your holidays!</p>
            <p style="margin-top: 25px; font-style: italic; font-size: 1.1em;">
                - Your Class Representative- @cristech üéÑüéâüéÅ
            </p>
        </section> -->
        <div class="christmas-lights"></div>
        <!-- Section 1: Hero -->
        <section class="hero" id="section-hero">
            <div class="hero-text">
                <h1 id="heroTitle">Bachelor of Science in Electrical and Electronics Engineering<br />
                    Chuka University<br />
                    2nd Year | Academic Year 2025‚Äì2026
                </h1>
                <p id="heroSubtitle">Innovate. Learn. Engineer.</p>
                <!-- Admin Edit Button -->
                <button class="admin-edit-btn" data-section="hero" onclick="openEditor('hero')" style="display: none;">
                    <i class="fas fa-edit"></i> Edit Hero
                </button>
            </div>
        </section>

        <!-- Section 2: About -->
        <section class="about" id="section-about">
            <h2>About This Site</h2>
            <p id="aboutContent">
                The BSCEEE Y2S1 class website is a centralized digital space designed to foster academic excellence,
                unity, and streamlined communication for students pursuing a Bachelor of Science in Electrical and
                Electronics Engineering at Chuka University. As a second-year class, we are building not only our
                engineering knowledge but also a collaborative culture that supports innovation and lifelong learning.
            </p>
            <!-- Admin Edit Button -->
            <button class="admin-edit-btn" data-section="about" onclick="openEditor('about')" style="display: none;">
                <i class="fas fa-edit"></i> Edit About
            </button>
        </section>

        <!-- Section 3: Features/Who We Are -->
        <section class="features" id="section-features">
            <div class="image-row">
                <figure><img src="GALLERY/hi image.jpg" alt=""></figure>
                <figure><img src="GALLERY/home image 2025-06-16 at 20.25.54_a0a50007.jpg" alt=""></figure>
                <figure><img src="GALLERY/home page 20.22.35_7f93281f.jpg" alt=""></figure>
            </div>
            <div class="features-text">
                <span id="featuresContent">
                    üß† <strong>Who We Are</strong><br>
                    BSCEEE Y2S1 is a class of 102 ambitious student engineers who value academic excellence, innovation,
                    and teamwork. We are driven by curiosity, inspired by technology, and committed to shaping the
                    future through smart solutions and ethical engineering practices.
                </span>
                <!-- Admin Edit Button -->
                <button class="admin-edit-btn" data-section="features" onclick="openEditor('features')"
                    style="display: none;">
                    <i class="fas fa-edit"></i> Edit Content
                </button>
            </div>
        </section>

        <!-- Section 4: News -->
        <section class="news" id="section-news">
            <h2><i class="fas fa-newspaper"></i> Latest News</h2>
            <div id="newsContent">
                <p>üì∞ <a href="https://ieee-pes.org/news/just-announced-2025-ieee-power-energy-society-award-recipients/"
                        target="_blank">2025 IEEE Power & Energy Society Awards winners announced</a>: Industry leaders
                    recognized for breakthroughs in power system stability, microgrid automation, and renewable
                    integration.</p>
                <p>üì∞ <a href="https://peopledaily.digital/business/kenya-power-faces-rising-electricity-losses"
                        target="_blank">Kenya Power fights rising electricity losses</a>: Transmission losses hit 23.7%,
                    prompting plans to modernize the grid by 2028 and save billions in revenue.</p>
                <p>üì∞ <a href="https://www.iafastro.org/news/the-iaf-is-proud-to-introduce-the-2025-iaf-emerging-space-leaders.html"
                        target="_blank">IAF names 2025 Emerging Space Leaders</a>: Highlighting students with
                    cutting-edge projects like CubeSats and satellite navigation, showcasing multidisciplinary
                    engineering in action.</p>
            </div>
            <!-- Admin Edit Button -->
            <button class="admin-edit-btn" data-section="news" onclick="openEditor('news')" style="display: none;">
                <i class="fas fa-edit"></i> Edit News
            </button>
        </section>

        <!-- Section 5: Fun Facts -->
        <section class="fun-facts" id="section-funfacts">
            <h2><i class="fas fa-lightbulb"></i> Fun Engineering Facts</h2>
            <ul id="funFactsContent">
                <li>The human brain produces about 20 watts of power ‚Äî enough to dimly light a small LED bulb.</li>
                <li>Elevators are the safest form of transport. They have up to 10 separate braking systems, and
                    statistically, they're safer than cars, trains, or planes.</li>
                <li>Bluetooth is named after a Viking king. King Harald "Bluetooth" united Denmark and Norway ‚Äî just
                    like Bluetooth unites devices.</li>
            </ul>
            <!-- Admin Edit Button -->
            <button class="admin-edit-btn" data-section="funFacts" onclick="openEditor('funFacts')"
                style="display: none;">
                <i class="fas fa-edit"></i> Edit Fun Facts
            </button>
        </section>

        <!-- Section 6: Student Spotlight -->
        <section class="spotlight" id="section-spotlight">
            <h2><i class="fas fa-star"></i> Student Spotlight</h2>
            <div id="spotlightContent">
                <p>Each semester, we'll feature students who show outstanding performance, innovation, leadership, or
                    community impact.</p>
                <p><em>Do something awesome ‚Äî and you might be next in the spotlight!</em></p>
            </div>
            <!-- Admin Edit Button -->
            <button class="admin-edit-btn" data-section="spotlight" onclick="openEditor('spotlight')"
                style="display: none;">
                <i class="fas fa-edit"></i> Edit Spotlight
            </button>
        </section>

        <!-- Section 7: Weekly Quiz -->
        <section class="quiz" id="section-quiz">
            <h2><i class="fas fa-brain"></i> Weekly Quiz</h2>
            <div id="quizContent">
                <p><strong>Background information:</strong> An engineering student is tasked with building a
                    rechargeable autonomous robot using the following components: an Arduino Uno, an ultrasonic sensor,
                    a servo motor, an L293D motor driver module, and a 2-wheel robot chassis kit.</p>
                <p>
                <ul>
                    <li>The Arduino Uno requires a power supply of 7V to 12V.</li>
                    <li>The servo motor and ultrasonic sensor operate at 5V.</li>
                    <li>The L293D motor driver has two power inputs:</li>
                    <ul>
                        <li style="padding-left: 5px;">Logic power (Vcc1): powers the internal logic circuitry,
                            typically 5V.</li>
                        <li style="padding-left: 5px;">Motor power (Vcc2): powers the motors and supports a voltage
                            range of 4.5V to 36V, depending on the motors used.</li>
                    </ul>
                    <li>In this project, the student is using TT motors rated from 3V to 9V.</li>
                </ul>
                </p>
                <p>The student has acquired two rechargeable Li-ion batteries (3000mAh, 3.7V each) and salvaged a
                    partially damaged power bank charge controller designed for charging these batteries. The charge
                    controller supports charging at 4.2V (maximum per cell), has a nominal voltage of 3.7V, and a cutoff
                    voltage of 3.0V. However, this controller cannot provide a 5V output at the USB port.
                    The robot will be powered by the two batteries, which will be charged using this power bank charge
                    controller.
                </p>
                <h3>Task:</h3>
                <h4>Design a power system that:</h4>
                <p>
                <ul>
                    <li>Supplies power to all components of the autonomous robot with the correct voltages.</li>
                    <li>Uses the two Li-ion batteries and the existing charge controller to charge the batteries safely.
                    </li>
                    <li>Includes a mechanism to switch between charging mode and usage mode.</li>
                </ul>
                </p>
                <p>Please provide a clear explanation and a block diagram or schematic of your design.</p>
            </div>
            <!-- Admin Edit Button -->
            <button class="admin-edit-btn" data-section="quiz" onclick="openEditor('quiz')" style="display: none;">
                <i class="fas fa-edit"></i> Edit Quiz
            </button>
        </section>

    </main>

    <!-- Admin Edit Modal -->
    <div id="adminModal" class="modal" style="display: none; z-index: 3000;">
        <div class="modal-content" style="background: white; padding: 30px; border-radius: 10px; max-width: 600px;">
            <span class="closeBtn" onclick="closeEditor()">&times;</span>
            <h3 id="modalTitle">Edit Content</h3>
            <textarea id="contentEditor"
                style="width: 100%; height: 300px; padding: 15px; border: 2px solid #ddd; border-radius: 8px; font-family: inherit; font-size: 16px;"></textarea>
            <div style="margin-top: 20px; text-align: right;">
                <button onclick="closeEditor()"
                    style="padding: 10px 20px; margin-right: 10px; background: #6c757d; color: white; border: none; border-radius: 5px; cursor: pointer;">Cancel</button>
                <button onclick="saveContent()"
                    style="padding: 10px 20px; background: #004080; color: white; border: none; border-radius: 5px; cursor: pointer;">Save
                    Changes</button>
            </div>
        </div>
    </div>

    <!-- Image Modal -->
    <div id="imageModal" class="modal">
        <span class="closeBtn" onclick="closeModal()">&times;</span>
        <img class="modal-content" id="modalImage">
    </div>

    <!-- Footer -->
    <!-- Footer -->
    <footer class="site-footer">
        <div class="footer-content">
            <div class="footer-links">
                <h3>Quick Links</h3>
                <ul>
                    <li><a href="https://www.chuka.ac.ke" target="_blank">Chuka University Website</a></li>
                    <li><a href="https://portal.chuka.ac.ke" target="_blank">Student Portal</a></li>
                </ul>
            </div>
        </div>
        <!-- <div class="footer-bottom">
            <p style="color: #ffd700; font-weight: bold;">üéÑ Wishing you a blessed Christmas and a well-deserved holiday
                break! üéâ</p>
            <p>&copy; 2025 BSCEEE Y2S1 ¬∑ Chuka University</p>
        </div> -->
    </footer>

    <script>

        let customSectionsLoaded = false;
        let customSections = new Set(); // Track loaded sections

        // Firebase Configuration
        const firebaseConfig = {
            apiKey: "AIzaSyD3oMlsv9C3Qepvkw_Y1JVfhVJiMwZLox4",
            authDomain: "bsceee-webpage.firebaseapp.com",
            databaseURL: "https://bsceee-webpage-default-rtdb.firebaseio.com",
            projectId: "bsceee-webpage",
            storageBucket: "bsceee-webpage.appspot.com",
            messagingSenderId: "281106710079",
            appId: "1:281106710079:web:2c6ab931bc3cab8e4e428a",
            measurementId: "G-B1M7SSEZYP"
        };








        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();
        const auth = firebase.auth();



        // ==================== BLOCK FIREBASE AUTO-REGISTRATION ====================
        console.log('üõë Blocking Firebase auto-service-worker-registration...');

        // Method 1: Patch the messaging prototype BEFORE Firebase loads
        if (typeof firebase !== 'undefined' && firebase.messaging) {
            // Get the messaging prototype
            const messagingPrototype = Object.getPrototypeOf(firebase.messaging());

            // Save the original method
            const originalRegisterDefaultSw = messagingPrototype._registerDefaultSw;

            // Override it to do nothing
            messagingPrototype._registerDefaultSw = function () {
                console.log('üõë BLOCKED: Firebase attempted to auto-register default service worker');
                console.log('‚úÖ Using our manually registered service worker instead');
                return Promise.resolve(); // Return resolved promise to prevent errors
            };

            console.log('‚úÖ Firebase auto-registration blocked successfully');
        }

        // Method 2: Also patch navigator.serviceWorker.register to intercept Firebase's calls
        const originalRegister = navigator.serviceWorker.register;
        navigator.serviceWorker.register = function (scriptURL, options) {
            console.log('Service Worker registration requested:', scriptURL);

            // Intercept Firebase's default registration
            if (scriptURL === 'http://127.0.0.1:5501/firebase-messaging-sw.js' ||
                scriptURL === '/firebase-messaging-sw.js') {
                console.log('üõë INTERCEPTED: Firebase default service worker registration');
                console.log('üîÄ Redirecting to: /class%20webpage/web/firebase-messaging-sw.js');

                // Redirect to our correct path
                return originalRegister.call(
                    this,
                    '/bsceeetitans/firebase-messaging-sw.js',
                    { scope: '/bsceeetitans/' }
                );
            }

            // Allow other registrations
            return originalRegister.call(this, scriptURL, options);
        };
        // ==================== FIREBASE MESSAGING SETUP ====================

        // Initialize Firebase Messaging
        let messaging = null;

        function initializeMessaging() {
            console.log('Initializing Firebase Messaging for GitHub Pages...');

            try {
                // Check if messaging is supported
                if (!firebase.messaging.isSupported()) {
                    console.log('Firebase Messaging not supported in this browser');
                    return;
                }

                // Get Firebase Messaging instance
                messaging = firebase.messaging();

                // GitHub Pages specific registration
                registerServiceWorkerForGitHub()
                    .then(() => {
                        console.log('‚úÖ Firebase Messaging ready');
                        requestNotificationPermission();
                        setupMessageListener();
                    })
                    .catch(error => {
                        console.error('‚ùå Failed to initialize:', error);
                    });

            } catch (error) {
                console.error('‚ùå Error initializing Firebase Messaging:', error);
            }
        }

        async function registerServiceWorkerForGitHub() {
            console.log('Registering Service Worker for GitHub Pages...');

            const basePath = getBasePath();
            console.log('Base path detected:', basePath);

            // Try multiple paths for GitHub Pages
            const swPaths = [

                '/bsceeetitans/firebase-messaging-sw.js'        // Root (for fallback)
            ];

            let registration = null;

            for (const swPath of swPaths) {
                try {
                    console.log('Trying path:', swPath);
                    registration = await navigator.serviceWorker.register(swPath, {
                        scope: './'  // Current directory scope for GitHub Pages
                    });

                    console.log('‚úÖ Service Worker registered with path:', swPath);
                    console.log('Scope:', registration.scope);

                    // For Firebase v10+, it should auto-detect the service worker
                    // But we can explicitly tell it
                    if (typeof messaging.useServiceWorker === 'function') {
                        messaging.useServiceWorker(registration);
                        console.log('‚úÖ Service Worker attached to Firebase');
                    }

                    return registration; // Return successfully

                } catch (error) {
                    console.log(`Path ${swPath} failed:`, error.message);
                    // Continue to next path
                }
            }

            throw new Error('All Service Worker registration attempts failed');
        }

        function getBasePath() {
            // Get current path and calculate base path for GitHub Pages
            const currentPath = window.location.pathname;

            // If we're at the root of GitHub Pages repo
            if (currentPath === '/' || currentPath.endsWith('/index.html')) {
                return './';
            }

            // If we're in a subdirectory (GitHub Pages repository)
            const pathParts = currentPath.split('/');
            // Remove empty parts and filename
            const filtered = pathParts.filter(part => part && !part.includes('.html'));

            if (filtered.length === 0) {
                return './';
            }

            // Build base path
            let basePath = '';
            for (let i = 0; i < filtered.length - 1; i++) {
                basePath += '../';
            }

            return basePath || './';
        }
        // Request notification permission
        // Request notification permission
        function requestNotificationPermission() {
            console.log('Requesting notification permission...');

            // Check if notifications are supported
            if (!('Notification' in window)) {
                console.log('This browser does not support notifications');
                return Promise.resolve('not-supported');
            }

            // Check current permission
            if (Notification.permission === 'granted') {
                console.log('Notification permission already granted');
                getFCMToken();
                return Promise.resolve('granted');
            }

            if (Notification.permission === 'denied') {
                console.log('Notification permission denied by user');

                // Show instruction to enable notifications
                showNotificationHelp();
                return Promise.resolve('denied');
            }

            // Request permission - show a custom prompt first
            return showCustomNotificationPrompt().then(userResponse => {
                if (userResponse === 'allow') {
                    return Notification.requestPermission().then(permission => {
                        console.log('Notification permission:', permission);
                        if (permission === 'granted') {
                            getFCMToken();
                        } else if (permission === 'denied') {
                            console.log('User denied notification permission');
                        }
                        return permission;
                    });
                } else {
                    console.log('User declined notification prompt');
                    return 'declined';
                }
            });
        }

        // Show custom notification prompt
        function showCustomNotificationPrompt() {
            return new Promise((resolve) => {
                // You can create a custom modal here
                // For now, we'll use a simple confirm
                const shouldRequest = confirm('Enable push notifications to get instant updates about new announcements?');
                resolve(shouldRequest ? 'allow' : 'decline');
            });
        }

        // Show help for enabling notifications
        function showNotificationHelp() {
            console.log('Notifications blocked. Instructions to enable:');
            // You could show a help modal here
        }

        // Get FCM token
        // Get FCM token
        function getFCMToken() {
            if (!messaging) {
                console.log('Messaging not initialized');
                return;
            }

            console.log('Getting FCM token...');

            // For Firebase v10, pass vapidKey in getToken()
            messaging.getToken({
                vapidKey: 'BMYtnObicSX3KWDOnLoOe7ZdO4qAzMO9q7tt4j1CdmUsvHYAdJfiLMWF6Y339UJKtw_2hmNnCGe58SeeiK2PX4k'
            })
                .then(currentToken => {
                    if (currentToken) {
                        console.log('FCM Token:', currentToken);
                        // Save token to Firebase
                        saveTokenToFirebase(currentToken);
                    } else {
                        console.log('No registration token available. Request permission to generate one.');
                        // Request permission again
                        requestNotificationPermission();
                    }
                })
                .catch(error => {
                    console.error('Error getting FCM token:', error);

                    // If permission is denied, don't try again
                    if (error.code === 'messaging/permission-blocked') {
                        console.log('Notification permission blocked by user');
                    } else if (error.code === 'messaging/permission-default') {
                        console.log('Notification permission not granted yet');
                    }
                });
        }

        // Save token to Firebase
        function saveTokenToFirebase(token) {
            const userId = auth.currentUser ? auth.currentUser.uid : 'anonymous';

            const tokenData = {
                token: token,
                userId: userId,
                timestamp: new Date().toISOString(),
                userAgent: navigator.userAgent
            };

            // Save to Firebase
            db.ref('fcmTokens/' + userId).set(tokenData)
                .then(() => {
                    console.log('FCM token saved to Firebase');
                })
                .catch(error => {
                    console.error('Error saving FCM token:', error);
                });
        }

        // Listen for incoming messages
        function setupMessageListener() {
            if (!messaging) {
                console.log('Messaging not initialized for listener');
                return;
            }

            // Handle foreground messages
            messaging.onMessage((payload) => {
                console.log('Message received in foreground:', payload);

                // Show notification
                showNotification(payload);

                // Update notification badge
                updateNotificationBadge();
            });

            console.log('Message listener setup complete');
        }

        // Show notification
        function showNotification(payload) {
            const title = payload.notification?.title || 'New Announcement';
            const body = payload.notification?.body || 'Check the class website for updates';

            // Create notification
            const notification = new Notification(title, {
                body: body,
                icon: 'pngegg.png',
                badge: 'pngegg.png',
                vibrate: [200, 100, 200],
                data: payload.data || {}
            });

            // Handle click
            notification.onclick = function (event) {
                event.preventDefault();
                window.focus();
                notification.close();

                // Navigate to announcements page
                if (payload.data && payload.data.url) {
                    window.location.href = payload.data.url;
                } else {
                    window.location.href = 'announcements.html';
                }
            };
        }
        // Check admin authentication status
        auth.onAuthStateChanged((user) => {
            if (user) {
                // User is signed in, check if admin
                checkAdminStatus(user.uid);
            } else {
                // User is signed out, hide admin features
                hideAdminFeatures();
            }
        });

        // Load dynamic content from Firebase
        function loadContent() {
            // Hero Section
            db.ref('websiteContent/hero').on('value', (snapshot) => {
                const data = snapshot.val();
                if (data) {
                    document.getElementById('heroTitle').textContent = data.title;
                    document.getElementById('heroSubtitle').textContent = data.subtitle;
                }
            });

            // About Section
            db.ref('websiteContent/about').on('value', (snapshot) => {
                const data = snapshot.val();
                if (data) {
                    document.getElementById('aboutContent').textContent = data.content;
                }
            });

            // Features Section
            db.ref('websiteContent/features').on('value', (snapshot) => {
                const data = snapshot.val();
                if (data) {
                    document.getElementById('featuresContent').innerHTML = data.content;
                }
            });

            // News Section
            db.ref('websiteContent/news').on('value', (snapshot) => {
                const data = snapshot.val();
                if (data) {
                    document.getElementById('newsContent').innerHTML = data.content;
                }
            });

            // Fun Facts Section
            db.ref('websiteContent/funFacts').on('value', (snapshot) => {
                const data = snapshot.val();
                if (data && data.items) {
                    const factsList = document.getElementById('funFactsContent');
                    factsList.innerHTML = '';
                    data.items.forEach(fact => {
                        const li = document.createElement('li');
                        li.textContent = fact;
                        factsList.appendChild(li);
                    });
                }
            });

            // Spotlight Section
            db.ref('websiteContent/spotlight').on('value', (snapshot) => {
                const data = snapshot.val();
                if (data) {
                    document.getElementById('spotlightContent').innerHTML = data.content;
                }
            });

            // Quiz Section
            db.ref('websiteContent/quiz').on('value', (snapshot) => {
                const data = snapshot.val();
                if (data) {
                    document.getElementById('quizContent').innerHTML = data.content;
                }
            });
        }

        // Admin editing functions
        let currentEditingSection = '';

        function openEditor(section) {
            currentEditingSection = section;
            const modal = document.getElementById('adminModal');
            const editor = document.getElementById('contentEditor');
            const modalTitle = document.getElementById('modalTitle');

            // Set modal title
            const sectionTitles = {
                'hero': 'Edit Hero Section',
                'about': 'Edit About Section',
                'features': 'Edit Features Section',
                'news': 'Edit News Section',
                'funFacts': 'Edit Fun Facts',
                'spotlight': 'Edit Student Spotlight',
                'quiz': 'Edit Weekly Quiz'
            };
            modalTitle.textContent = sectionTitles[section] || 'Edit Content';

            // Get current content
            let currentContent = '';
            switch (section) {
                case 'hero':
                    currentContent = document.getElementById('heroTitle').textContent + '\n---\n' + document.getElementById('heroSubtitle').textContent;
                    break;
                case 'about':
                    currentContent = document.getElementById('aboutContent').textContent;
                    break;
                case 'features':
                    currentContent = document.getElementById('featuresContent').innerHTML;
                    break;
                case 'news':
                    currentContent = document.getElementById('newsContent').innerHTML;
                    break;
                case 'funFacts':
                    const facts = Array.from(document.getElementById('funFactsContent').getElementsByTagName('li')).map(li => li.textContent);
                    currentContent = facts.join('\n');
                    break;
                case 'spotlight':
                    currentContent = document.getElementById('spotlightContent').innerHTML;
                    break;
                case 'quiz':
                    currentContent = document.getElementById('quizContent').innerHTML;
                    break;
            }

            editor.value = currentContent;
            modal.style.display = 'block';
        }

        function closeEditor() {
            document.getElementById('adminModal').style.display = 'none';
        }

        function saveContent() {
            const newContent = document.getElementById('contentEditor').value;

            // Save to Firebase based on section
            switch (currentEditingSection) {
                case 'hero':
                    const lines = newContent.split('\n---\n');
                    db.ref('websiteContent/hero').set({
                        title: lines[0] || '',
                        subtitle: lines[1] || ''
                    });
                    break;
                case 'about':
                    db.ref('websiteContent/about').set({
                        content: newContent
                    });
                    break;
                case 'features':
                    db.ref('websiteContent/features').set({
                        content: newContent
                    });
                    break;
                case 'news':
                    db.ref('websiteContent/news').set({
                        content: newContent
                    });
                    break;
                case 'funFacts':
                    const facts = newContent.split('\n').filter(fact => fact.trim() !== '');
                    db.ref('websiteContent/funFacts').set({
                        items: facts
                    });
                    break;
                case 'spotlight':
                    db.ref('websiteContent/spotlight').set({
                        content: newContent
                    });
                    break;
                case 'quiz':
                    db.ref('websiteContent/quiz').set({
                        content: newContent
                    });
                    break;
            }

            closeEditor();
            alert('Content updated successfully!');
        }

        // Check if user is admin and show/hide features accordingly
        function checkAdminStatus(uid) {
            db.ref('admins/' + uid).once('value').then((snapshot) => {
                if (snapshot.exists()) {
                    showAdminFeatures();
                } else {
                    hideAdminFeatures();
                }
            });
        }

        function showAdminFeatures() {
            document.querySelectorAll('.admin-edit-btn').forEach(btn => {
                btn.style.display = 'inline-block';
            });
            document.getElementById('adminIndicator').style.display = 'block';
            document.getElementById('adminDashboardLink').style.display = 'block';
            document.getElementById('adminLoginLink').style.display = 'none';
        }

        function hideAdminFeatures() {
            document.querySelectorAll('.admin-edit-btn').forEach(btn => {
                btn.style.display = 'none';
            });
            document.getElementById('adminIndicator').style.display = 'none';
            document.getElementById('adminDashboardLink').style.display = 'none';
            document.getElementById('adminLoginLink').style.display = 'block';
        }
        // ==================== NOTIFICATION BELL FUNCTIONALITY ====================

        // Add shake animation for bell
        const style = document.createElement('style');
        style.textContent = `
    @keyframes shake {
        0%, 100% { transform: rotate(0deg); }
        25% { transform: rotate(-15deg); }
        75% { transform: rotate(15deg); }
    }
`;
        document.head.appendChild(style);

        // SIMPLE VERSION - Just show total active announcements
        // ==================== NOTIFICATION SYSTEM ====================

        // Update notification badge
        function updateNotificationBadge() {
            console.log(`[${new Date().toLocaleTimeString()}] üîî updateNotificationBadge() called`);

            const badge = document.getElementById('notificationCount');
            if (!badge) {
                console.error('‚ùå Badge element not found!');
                return;
            }

            console.log('üì° Reading from Firebase: announcements');

            db.ref('announcements').once('value')
                .then(snapshot => {
                    if (!snapshot.exists()) {
                        console.log('üì≠ No announcements found');
                        badge.textContent = '0';
                        badge.style.display = 'none';
                        return;
                    }

                    const data = snapshot.val();
                    console.log('üìä Raw data:', data);
                    console.log('üìä Number of announcements:', Object.keys(data).length);

                    // Count ALL announcements (for now)
                    const count = Object.keys(data).length;
                    console.log(`üìä Total count: ${count}`);

                    if (count > 0) {
                        badge.textContent = count > 9 ? '9+' : count.toString();
                        badge.style.display = 'flex';
                        console.log(`‚úÖ Badge updated to: ${badge.textContent}`);

                        // Add animation to bell
                        const bell = document.querySelector('.notification-icon a i');
                        if (bell) {
                            bell.style.animation = 'shake 0.5s ease-in-out';
                            setTimeout(() => {
                                bell.style.animation = '';
                            }, 500);
                        }
                    } else {
                        badge.textContent = '0';
                        badge.style.display = 'none';
                        console.log('‚úÖ No announcements');
                    }
                })
                .catch(error => {
                    console.error('‚ùå Firebase error:', error);
                    badge.textContent = '0';
                    badge.style.display = 'none';
                });
        }

        // Setup notification click handler
        function setupNotificationClick() {
            const notificationBell = document.getElementById('notificationBell');
            if (notificationBell) {
                notificationBell.addEventListener('click', function (e) {
                    console.log('üîî Bell clicked!');
                    // Just navigate to announcements page
                    // No need to prevent default since it's a link
                });
            }
        }

        // Initialize notification system
        function initNotificationSystem() {
            console.log('üîî Initializing notification system...');

            // First immediate check
            updateNotificationBadge();

            // Check again after Firebase is likely ready
            setTimeout(updateNotificationBadge, 1000);

            // Check again after 3 seconds
            setTimeout(updateNotificationBadge, 3000);

            // Setup click handler
            setupNotificationClick();

            // Regular polling every 30 seconds
            setInterval(updateNotificationBadge, 30000);

            console.log('‚úÖ Notification system initialized');
        }
        // Initialize
        // ==================== SINGLE DOMContentLoaded ====================
        document.addEventListener('DOMContentLoaded', function () {
            console.log('üöÄ DOM fully loaded - Initializing everything...');

            // 1. PWA Service Worker
            // Replace the PWA service worker registration with this:
            if ('serviceWorker' in navigator) {
                const basePath = getBasePath();
                const swPath = basePath + 'sw.js';

                console.log('üì± Registering PWA Service Worker for GitHub Pages:', swPath);

                navigator.serviceWorker.register(swPath, {
                    scope: basePath
                })
                    .then(registration => {
                        console.log('‚úÖ PWA Service Worker registered for GitHub Pages:', registration.scope);
                    })
                    .catch(error => {
                        console.log('‚ùå PWA Service Worker failed, trying alternatives...');

                        // Try alternatives
                        const altPaths = ['./sw.js', 'sw.js', '/sw.js'];

                        // Use a function to try paths sequentially
                        const tryRegister = (index) => {
                            if (index >= altPaths.length) return;

                            navigator.serviceWorker.register(altPaths[index])
                                .then(reg => {
                                    console.log('‚úÖ PWA Service Worker registered with:', altPaths[index]);
                                })
                                .catch(e => {
                                    console.log(`Path ${altPaths[index]} failed:`, e.message);
                                    tryRegister(index + 1); // Try next path
                                });
                        };

                        tryRegister(0); // Start with first path
                    });
            }

            // 2. PWA Install Button
            let deferredPrompt;
            const installButton = document.getElementById('installButton');

            if (installButton) {
                window.addEventListener('beforeinstallprompt', (e) => {
                    deferredPrompt = e;
                    installButton.style.display = 'block';
                    console.log('üéâ PWA install available!');
                });

                installButton.addEventListener('click', async () => {
                    console.log('Install button clicked!');

                    if (deferredPrompt) {
                        deferredPrompt.prompt();
                        const { outcome } = await deferredPrompt.userChoice;

                        if (outcome === 'accepted') {
                            installButton.innerHTML = '<i class="fas fa-check"></i> Installed';
                            installButton.disabled = true;
                            installButton.style.background = 'green';
                            return;
                        }
                    }

                    alert(`üì± HOW TO INSTALL THIS APP

**For Desktop (Chrome/Edge):**
1. Look for the INSTALL icon (üì•) in the address bar
2. OR Click the menu (‚ãÆ) ‚Üí "Install BSCEEE Y2S1"

**For iPhone/iPad (Safari):**
1. Tap the SHARE button (‚éã)
2. Scroll down, tap "Add to Home Screen"
3. Tap "Add" in top right

**For Android (Chrome):**
1. Tap the menu (‚ãÆ or ‚´∂)
2. Tap "Add to Home Screen" or "Install App"
3. Tap "Add" or "Install"

**If no option appears:**
‚Ä¢ Refresh the page
‚Ä¢ Visit the site multiple times
‚Ä¢ Make sure you're using Chrome/Edge/Safari`);
                });

                window.addEventListener('appinstalled', () => {
                    console.log('PWA was installed');
                    installButton.style.display = 'none';
                    deferredPrompt = null;
                });
            }

            // 3. PWA Requirements Check
            console.log('üîç PWA Requirements Check:');
            const isSecure = window.location.protocol === 'https:' ||
                window.location.hostname === 'localhost' ||
                window.location.hostname === '127.0.0.1';
            console.log('1. HTTPS/Localhost:', isSecure);
            console.log('2. Service Worker support:', 'serviceWorker' in navigator);
            console.log('3. Manifest:', document.querySelector('link[rel="manifest"]')?.href);
            console.log('4. Already installed:', window.matchMedia('(display-mode: standalone)').matches);

            // 4. Visit counter for Safari PWA
            window.addEventListener('load', function () {
                let visitCount = localStorage.getItem('pwa_visit_count') || 0;
                visitCount++;
                localStorage.setItem('pwa_visit_count', visitCount);
                console.log(`Visit count: ${visitCount}`);

                if (visitCount >= 2) {
                    console.log('Safari should show install option now');
                }
            });

            // 5. Load dynamic content
            loadContent();

            // 6. Theme Toggle
            const themeToggle = document.getElementById('themeToggle');
            const html = document.documentElement;
            const savedTheme = localStorage.getItem('theme') || 'light';
            html.setAttribute('data-theme', savedTheme);

            function updateThemeIcon(theme) {
                const icon = themeToggle.querySelector('i');
                icon.className = theme === 'light' ? 'fas fa-moon' : 'fas fa-sun';
            }
            updateThemeIcon(savedTheme);

            themeToggle.addEventListener('click', () => {
                const currentTheme = html.getAttribute('data-theme');
                const newTheme = currentTheme === 'light' ? 'dark' : 'light';
                html.setAttribute('data-theme', newTheme);
                localStorage.setItem('theme', newTheme);
                updateThemeIcon(newTheme);
            });

            // 7. Sidebar Toggle
            const menuBtn = document.getElementById('menuBtn');
            const sidebar = document.getElementById('sidebar');
            const overlay = document.getElementById('overlay');

            menuBtn.addEventListener('click', () => {
                sidebar.classList.toggle('active');
                overlay.classList.toggle('active');
            });

            overlay.addEventListener('click', () => {
                sidebar.classList.remove('active');
                overlay.classList.remove('active');
            });

            // 8. Image Modal - FIX THIS
            const modal = document.getElementById("imageModal");
            const modalImg = document.getElementById("modalImage");

            // ADD NULL CHECK:
            if (modal && modalImg) {
                const featureImages = document.querySelectorAll(".features img");
                if (featureImages.length > 0) {
                    featureImages.forEach(img => {
                        img.addEventListener("click", () => {
                            modal.style.display = "block";
                            modalImg.src = img.src;
                        });
                    });
                }
            }

            function closeModal() {
                if (modal) modal.style.display = "none";
            }
            window.closeModal = closeModal;
            function closeModal() {
                modal.style.display = "none";
            }
            window.closeModal = closeModal;

            // 9. Initialize Christmas Theme
            console.log('üéÑ Initializing Christmas theme...');
            initChristmasTheme();

            // 10. Load Custom Sections
            let isInitialLoad = true;
            db.ref('customSections').on('value', function (snapshot) {
                // Remove all existing custom sections
                document.querySelectorAll('.custom-section').forEach(section => {
                    if (section.id !== 'christmas-sections') {
                        section.remove();
                    }
                });

                // Load new sections
                if (snapshot.exists()) {
                    loadCustomSections();
                }

                isInitialLoad = false;
            });

            // In your DOMContentLoaded function, replace lines 11. Initialize Notification System:

            // 11. Initialize Notification System
            console.log('üîî Setting up notification system...');
            initNotificationSystem();

            // Check when page becomes visible again
            document.addEventListener('visibilitychange', function () {
                if (!document.hidden) {
                    console.log('üîî Page visible, checking notifications...');
                    updateNotificationBadge();
                }
            });

            // Also check on page load after a short delay
            // Wait for Firebase to be ready
            const checkFirebaseAndUpdate = () => {
                if (firebase.apps.length > 0) {
                    console.log('‚úÖ Firebase ready, updating badge...');
                    updateNotificationBadge();
                } else {
                    console.log('‚è≥ Waiting for Firebase...');
                    setTimeout(checkFirebaseAndUpdate, 500);
                }
            };

            // Call it after a short delay
            setTimeout(checkFirebaseAndUpdate, 1000);

            console.log('‚úÖ ALL SYSTEMS INITIALIZED!');
            // Initialize Firebase Messaging
            setTimeout(() => {
                initializeMessaging();
                setupMessageListener();
            }, 3000);
        });





        // Load Custom Sections and inject them in correct positions
        function loadCustomSections() {
            if (customSectionsLoaded) {
                console.log('Custom sections already loaded, skipping...');
                return;
            }

            console.log('üîÑ Loading custom sections...');

            db.ref('customSections').once('value')
                .then(snapshot => {
                    const data = snapshot.val();

                    if (!data) {
                        console.log('‚ùå No custom sections found');
                        customSectionsLoaded = true;
                        return;
                    }

                    // Clear existing custom sections (except christmas)
                    document.querySelectorAll('.custom-section').forEach(section => {
                        if (!section.classList.contains('christmas-section')) {
                            section.remove();
                        }
                    });

                    // Reset tracking
                    customSections.clear();

                    // Convert to array and sort
                    const sectionsArray = Object.keys(data).map(key => ({
                        id: key,
                        ...data[key]
                    })).sort((a, b) => a.order - b.order);

                    // Inject sections
                    sectionsArray.forEach(section => {
                        if (!customSections.has(section.id)) {
                            injectCustomSection(section);
                            customSections.add(section.id);
                        }
                    });

                    customSectionsLoaded = true;
                    console.log(`‚úÖ Loaded ${customSections.size} custom sections`);
                })
                .catch(error => {
                    console.error('‚ùå Error loading custom sections:', error);
                    customSectionsLoaded = true;
                });
        }

        // Update the event handler
        db.ref('customSections').on('value', function (snapshot) {
            // Reset flag to allow reloading
            customSectionsLoaded = false;
            loadCustomSections();
        });

        function injectCustomSection(section) {
            const sectionHtml = renderCustomSection(section);
            const sectionElement = createSectionElement(sectionHtml);

            // Determine where to insert based on order number
            let insertAfterElement = null;

            if (section.order < 1.5) {
                insertAfterElement = document.getElementById('section-hero');
            } else if (section.order < 2.5) {
                insertAfterElement = document.getElementById('section-about');
            } else if (section.order < 3.5) {
                insertAfterElement = document.getElementById('section-features');
            } else if (section.order < 4.5) {
                insertAfterElement = document.getElementById('section-news');
            } else if (section.order < 5.5) {
                insertAfterElement = document.getElementById('section-funfacts');
            } else if (section.order < 6.5) {
                insertAfterElement = document.getElementById('section-spotlight');
            } else {
                insertAfterElement = document.getElementById('section-quiz');
            }

            if (insertAfterElement) {
                insertAfterElement.insertAdjacentHTML('afterend', sectionHtml);
                console.log(`‚úÖ Injected section "${section.title}" after ${insertAfterElement.id}`);
            } else {
                // Fallback: append to main content
                document.querySelector('main').insertAdjacentHTML('beforeend', sectionHtml);
                console.log(`‚úÖ Appended section "${section.title}" to end`);
            }
        }

        function createSectionElement(html) {
            const template = document.createElement('template');
            template.innerHTML = html;
            return template.content.firstElementChild;
        }

        function renderCustomSection(section) {
            const bgStyle = ''; // Remove background style completely

            return `
        <section class="custom-section" id="${section.id}" ${bgStyle}>
            <div class="section-content">
                <h2>${section.title}</h2>
                ${renderSectionContent(section)}
            </div>
            ${getAdminEditButton(section.id)}
        </section>
    `;
        }

        function renderSectionContent(section) {
            switch (section.type) {
                case 'text':
                    return `<div class="text-content">${section.content.replace(/\n/g, '<br>')}</div>`;

                case 'documents':
                    if (!section.documents || section.documents.length === 0) {
                        return '<p>No documents available.</p>';
                    }
                    return `
                <div class="documents-grid">
                    ${section.documents.map(doc => `
                        <div class="document-card">
                            <h4>${doc.title}</h4>
                            ${doc.description ? `<p>${doc.description}</p>` : ''}
                            <a href="${doc.link}" target="_blank" class="doc-link">
                                <i class="fas fa-download"></i> Download
                            </a>
                        </div>
                    `).join('')}
                </div>
            `;

                case 'links':
                    if (!section.links || section.links.length === 0) {
                        return '<p>No links available.</p>';
                    }
                    return `
                <div class="links-list">
                    ${section.links.map(link => `
                        <div class="link-item">
                            <a href="${link.url}" target="_blank" class="link-url">
                                <i class="fas fa-external-link-alt"></i> ${link.text}
                            </a>
                            ${link.description ? `<p class="link-desc">${link.description}</p>` : ''}
                        </div>
                    `).join('')}
                </div>
            `;

                case 'custom':
                    return section.customHTML || '<p>No content available.</p>';

                default:
                    return '<p>Unsupported section type.</p>';
            }
        }

        function getAdminEditButton(sectionId) {
            return `
        <button class="admin-edit-btn" data-section="custom_${sectionId}" onclick="openCustomSectionEditor('${sectionId}')" style="display: none;">
            <i class="fas fa-edit"></i> Edit Section
        </button>
    `;
        }

        function openCustomSectionEditor(sectionId) {
            // Redirect to admin dashboard
            if (confirm('This will take you to the admin dashboard to edit this section. Continue?')) {
                window.location.href = 'admin-dashboard.html';
            }
        }




        /* // ==================== CHRISTMAS FUNCTIONS ====================
  
          // Create animated snowflakes
          function createSnowflakes() {
              const container = document.getElementById('snowflakesContainer');
              if (!container) {
                  console.log('Snowflakes container not found');
                  return;
              }
  
              // Clear existing snowflakes
              container.innerHTML = '';
  
              const now = new Date();
              const month = now.getMonth();
  
              // Only show snowflakes in December (month 11)
              if (month !== 11) {
                  console.log('Not December - no snowflakes');
                  return;
              }
  
              const flakes = ['‚ùÑ', '‚ùÖ', '‚ùÜ'];
  
              // Create 20 snowflakes
              for (let i = 0; i < 20; i++) {
                  const flake = document.createElement('div');
                  flake.className = 'snowflake';
                  flake.textContent = flakes[Math.floor(Math.random() * flakes.length)];
  
                  // Random position
                  flake.style.left = Math.random() * 100 + '%';
  
                  // Random size (1.5-3em)
                  const size = Math.random() * 1.5 + 1.5;
                  flake.style.fontSize = size + 'em';
  
                  // Random animation
                  const duration = Math.random() * 3 + 2;
                  const delay = Math.random() * 3;
  
                  flake.style.animationDuration = duration + 's';
                  flake.style.animationDelay = delay + 's';
  
                  // Random opacity
                  flake.style.opacity = Math.random() * 0.4 + 0.6;
  
                  container.appendChild(flake);
              }
  
              console.log('Created snowflakes');
          }
  
          // Christmas countdown banner
          function addChristmasCountdown() {
              const now = new Date();
              const month = now.getMonth();
              const date = now.getDate();
  
              // Only show in December
              if (month !== 11) return;
  
              // Don't show after December 26
              if (date > 26) return;
  
              const christmas = new Date(now.getFullYear(), 11, 25);
              const diff = christmas - now;
              const days = Math.ceil(diff / (1000 * 60 * 60 * 24));
  
              // Create countdown banner
              const countdown = document.createElement('div');
              countdown.className = 'christmas-banner fade-in';
  
              let message = '';
              if (days === 0) {
                  message = 'üéÖ MERRY CHRISTMAS! Wishing you joy and SuccessüéÑ';
              } else if (days === 1) {
                  message = 'üéÑ Christmas Eve! One more day!üéÖ';
              } else if (days <= 5) {
                  message = `üéÑ Only ${days} days until Christmas!üéÖ`;
              } else {
                  message = `üéÑ ${days} days until Christmas! üéÖ`;
              }
  
              countdown.innerHTML = `
          <h3>${message}</h3>
          <p>Celebrate your exam success and enjoy the holiday season!üéì‚ú®</p>
      `;
  
              // Insert after snowflakes container
              const snowflakesContainer = document.getElementById('snowflakesContainer');
              if (snowflakesContainer) {
                  snowflakesContainer.insertAdjacentElement('afterend', countdown);
              }
          }
  
          // Initialize Christmas theme
          function initChristmasTheme() {
              console.log('üéÑ Initializing Christmas theme...');
  
              // Add Christmas mode to hero section
              const heroSection = document.getElementById('section-hero');
              if (heroSection) {
                  heroSection.classList.add('christmas-mode');
              }
  
              // Create snowflakes
              createSnowflakes();
  
              // Add countdown banner
              addChristmasCountdown();
  
              // Add Christmas lights between sections
              addChristmasLights();
  
              console.log('‚úÖ Christmas theme initialized');
          }
  
          // Add Christmas lights between major sections
          function addChristmasLights() {
              const sections = [
                  'section-hero',
                  'section-about',
                  'section-features',
                  'section-news',
                  'section-funfacts',
                  'section-spotlight',
                  'section-quiz'
              ];
  
              sections.forEach(sectionId => {
                  const section = document.getElementById(sectionId);
                  if (section && section.nextElementSibling) {
                      const lights = document.createElement('div');
                      lights.className = 'christmas-lights';
                      section.insertAdjacentElement('afterend', lights);
                  }
              });
          } */








    </script>

</body>

</html>

